<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liquor Management System</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-brand">
            <h1>üç∫ Liquor Shop</h1>
        </div>
        <div class="nav-menu" id="navMenu">
            <a href="#" class="nav-link active" data-page="sell">Sell</a>
            <a href="#" class="nav-link" data-page="stock">Stock</a>
            <a href="#" class="nav-link" data-page="transactions">Transactions</a>
            <a href="#" class="nav-link" data-page="analytics">Analytics</a>
            <a href="#" class="nav-link" data-page="stock-history">Stock History</a>
        </div>
        <button class="nav-toggle" id="navToggle">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <!-- Sell Page (Default) -->
        <div class="page active" id="sellPage">
            <div class="page-header">
                <h2>üí∞ Point of Sale</h2>
                <p>Build a cart, enter customer details, and complete the sale.</p>
            </div>

            <form id="sellForm">
                <!-- Add Item Section -->
                <div class="section">
                    <h3>1. Add Item to Cart</h3>
                    <div class="form-group">
                        <label for="brandSearch">Search Brand</label>
                        <div class="search-container">
                            <input type="text" id="brandSearch" placeholder="Type to search brands..." autocomplete="off">
                            <div class="suggestions" id="brandSuggestions"></div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="quantity">Quantity</label>
                            <input type="number" id="quantity" min="1" value="1" required>
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-success" id="addToCartBtn" disabled>‚ûï Add to Cart</button>
                        </div>
                    </div>
                </div>

                <!-- Shopping Cart Section -->
                <div class="section" id="cartSection" style="display: none;">
                    <div class="cart-header">
                        <h3>2. Shopping Cart</h3>
                        <button type="button" class="btn btn-warning btn-small" id="clearCartBtn">üóëÔ∏è Clear Cart</button>
                    </div>
                    <div id="cartItems" class="cart-items"></div>
                    <div class="cart-summary">
                        <div class="cart-total">
                            <strong>Cart Total: ‚Çπ<span id="cartTotal">0</span></strong>
                        </div>
                    </div>
                </div>

                <!-- Checkout Section -->
                <div class="section" id="checkoutDetailsSection">
                    <h3>3. Finalize Sale</h3>
                    <div class="form-row">
                         <div class="form-group">
                            <label for="paymentMethod">Payment Method</label>
                            <select id="paymentMethod" required>
                                <option value="cash">üíµ Cash</option>
                                <option value="upi">üì± UPI/QR</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customerName">Customer Name (Optional)</label>
                            <input type="text" id="customerName" placeholder="Enter customer name">
                        </div>
                        <div class="form-group">
                            <label for="customerPhone">Customer Phone (Optional)</label>
                            <input type="tel" id="customerPhone" placeholder="Enter phone number">
                        </div>
                    </div>
                    <div class="checkout-summary">
                        <div class="final-total">
                            <span>Final Amount: ‚Çπ<span id="checkoutTotal">0</span></span>
                        </div>
                        <button type="submit" class="btn btn-primary" id="checkoutBtn" disabled>üõí Complete Sale</button>
                    </div>
                </div>
            </form>
        </div>

        <!-- Stock Management Page -->
        <div class="page" id="stockPage">
            <div class="page-header">
                <h2>üì¶ Stock Management</h2>
                <p>Add, remove, and manage inventory</p>
            </div>

            <!-- Add Stock Section -->
            <div class="section">
                <h3>‚ûï Add Stock</h3>
                <form class="stock-form" id="addStockForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="brandName">Brand Name</label>
                            <input type="text" id="brandName" placeholder="e.g., Johnnie Walker" required>
                        </div>
                        <div class="form-group">
                            <label for="brandType">Type/Size</label>
                            <input type="text" id="brandType" placeholder="e.g., Black Label 750ml" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="brandPrice">Price per Bottle (‚Çπ)</label>
                            <input type="number" id="brandPrice" min="0" step="0.01" placeholder="Enter price" required>
                        </div>
                        <div class="form-group">
                            <label for="brandQuantity">Quantity</label>
                            <input type="number" id="brandQuantity" min="1" placeholder="Enter quantity" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">‚ûï Add to Stock</button>
                </form>
                
                <!-- Total Stock Value -->
                <div class="stock-summary">
                    <div class="total-stock-value">
                        <div class="value" id="totalStockValue">‚Çπ0</div>
                        <div class="label">Total Stock Value</div>
                    </div>
                </div>
                
                <!-- Stock Entry History -->
                <div class="stock-history-section">
                    <h4>üìà Stock Entry History</h4>
                    <div class="stock-history-actions">
                        <button class="btn btn-small" id="viewStockHistoryBtn">üìã View Full History</button>
                    </div>
                    <div class="stock-entries-list" id="stockEntriesList">
                        <div class="loading">Loading stock entries...</div>
                    </div>
                </div>
            </div>

            <!-- Current Stock Section -->
            <div class="section">
                <h3>üìã Current Stock</h3>
                <div class="stock-filters">
                    <input type="text" id="stockSearch" placeholder="Search stock...">
                    <select id="stockFilter">
                        <option value="all">All Stock</option>
                        <option value="low">Low Stock (‚â§5)</option>
                        <option value="out">Out of Stock</option>
                    </select>
                </div>
                <div class="stock-grid" id="stockGrid">
                    <div class="loading">Loading stock...</div>
                </div>
            </div>
        </div>

        <!-- Transactions Page -->
        <div class="page" id="transactionsPage">
            <div class="page-header">
                <h2>üìä Transaction History</h2>
                <p>View and manage all sales transactions</p>
            </div>

            <div class="section">
                <div class="filters">
                    <div class="filter-group">
                        <label>Date Range:</label>
                        <select id="dateFilter">
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="year">This Year</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Payment Method:</label>
                        <select id="paymentFilter">
                            <option value="all">All Payments</option>
                            <option value="cash">üíµ Cash Only</option>
                            <option value="upi">üì± UPI/QR Only</option>
                        </select>
                    </div>
                    <div class="filter-group custom-dates" id="customDates" style="display: none;">
                        <input type="date" id="dateFrom">
                        <span>to</span>
                        <input type="date" id="dateTo">
                        <button type="button" class="btn btn-small" id="applyDateFilter">Apply</button>
                    </div>
                </div>

                <div class="transactions-summary" id="transactionsSummary"></div>
                <div class="transactions-list" id="transactionsList">
                    <div class="loading">Loading transactions...</div>
                </div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div class="page" id="analyticsPage">
            <div class="page-header">
                <h2>üìà Analytics Dashboard</h2>
                <p>Business insights and performance metrics</p>
            </div>

            <div class="analytics-filters">
                <select id="analyticsDateFilter">
                    <option value="today">Today</option>
                    <option value="week">This Week</option>
                    <option value="month">This Month</option>
                    <option value="year">This Year</option>
                    <option value="all">All Time</option>
                </select>
            </div>

            <div class="metrics-grid" id="metricsGrid">
                <div class="loading">Loading analytics...</div>
            </div>

            <div class="charts-section">
                <div class="chart-container">
                    <h3>Top Selling Brands</h3>
                    <div id="topBrandsChart" class="chart-placeholder">Loading chart...</div>
                </div>
            </div>
        </div>

        <!-- Stock History Page -->
        <div class="page" id="stock-historyPage">
            <div class="page-header">
                <h2>üìà Stock Entry History</h2>
                <p>Detailed record of all stock additions over time</p>
            </div>

            <div class="section">
                <div class="history-summary" id="historySummary">
                    <div class="summary-card">
                        <div class="value" id="totalHistoryValue">‚Çπ0</div>
                        <div class="label">Total Stock Added (All Time)</div>
                    </div>
                </div>

                <div class="stock-history-content">
                    <h3>üìä Stock Additions by Week</h3>
                    <div class="stock-history-list" id="stockHistoryList">
                        <div class="loading">Loading stock history...</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Password Modal for Sensitive Operations -->
    <div class="modal" id="passwordModal" style="display: none;">
        <div class="modal-content">
            <h3>üîí Owner Authentication Required</h3>
            <p>This operation requires owner password verification.</p>
            <input type="password" id="ownerPassword" placeholder="Enter owner password">
            <div class="modal-buttons">
                <button type="button" class="btn btn-danger" id="confirmAction">Confirm</button>
                <button type="button" class="btn btn-secondary" id="cancelAction">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Custom Dialog Modal -->
    <div class="modal" id="customDialog" style="display: none;">
        <div class="modal-content">
            <h3 id="dialogTitle">Confirm Action</h3>
            <p id="dialogMessage">Are you sure?</p>
            <div id="dialogInput" style="display: none; margin-top: 15px;">
                <label id="inputLabel" for="dialogInputField">Enter value:</label>
                <input type="number" id="dialogInputField" class="form-input" min="0">
                <div id="inputHelp" style="font-size: 0.9rem; color: #666; margin-top: 5px;"></div>
            </div>
            <div class="modal-buttons">
                <button id="dialogConfirm" class="btn btn-primary">Confirm</button>
                <button id="dialogCancel" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Restock Modal -->
    <div class="modal" id="restockModal" style="display: none;">
        <div class="modal-content">
            <h3 id="restockTitle">üîÑ Restock Item</h3>
            <p id="restockMessage">Add more inventory for this item:</p>
            <div style="margin: 15px 0;">
                <label for="restockQuantity">Quantity to Add:</label>
                <input type="number" id="restockQuantity" class="form-input" min="1" value="1">
            </div>
            <div style="margin: 15px 0;">
                <label for="restockPrice">Price per Bottle (‚Çπ):</label>
                <input type="number" id="restockPrice" class="form-input" min="0" step="0.01">
            </div>
            <div id="restockInfo" style="font-size: 0.9rem; color: #666; margin-top: 10px;"></div>
            <div class="modal-buttons">
                <button id="restockConfirm" class="btn btn-primary">üîÑ Restock</button>
                <button id="restockCancel" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script type="module" src="./app.js"></script>
</body>
</html>
